<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Admin Panel</h2>

<h3>Set GEL Price</h3>
<input type="number" id="price" placeholder="New Price">
<button onclick="setPrice()">Update</button>

<h3>All Orders</h3>
<div id="orders"></div>

<script>
const token = localStorage.getItem("token");

async function setPrice() {
  const price = document.getElementById("price").value;

  await fetch("/api/admin/set-price", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: token
    },
    body: JSON.stringify({ gelPrice: price })
  });

  alert("Price Updated");
}

async function loadOrders() {
  const res = await fetch("/api/admin/orders", {
    headers: { Authorization: token }
  });

  const data = await res.json();

  let html = "";
  data.forEach(o => {
    html += `
      <p>
        ${o.user.email} | ${o.type} | ${o.amount} | ${o.status}
        <button onclick="approve('${o._id}')">Approve</button>
        <button onclick="reject('${o._id}')">Reject</button>
      </p>
    `;
  });

  document.getElementById("orders").innerHTML = html;
}

async function approve(id) {
  await fetch("/api/orders/approve/" + id, {
    method: "POST",
    headers: { Authorization: token }
  });
  loadOrders();
}

async function reject(id) {
  await fetch("/api/orders/reject/" + id, {
    method: "POST",
    headers: { Authorization: token }
  });
  loadOrders();
}

loadOrders();
</script>

</body>
</html>
